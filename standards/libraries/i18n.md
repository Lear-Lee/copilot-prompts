# 国际化 (i18n) 规范

## 核心原则

1. **零硬编码** - 所有用户可见文本必须使用翻译键
2. **结构化键名** - 使用点分层级（如 `user.profile.title`）
3. **参数化文本** - 使用占位符而非字符串拼接

## Vue I18n 配置

### 基础设置
```typescript
// src/i18n/index.ts
import { createI18n } from 'vue-i18n'
import zhCN from './locales/zh-CN'
import enUS from './locales/en-US'

const i18n = createI18n({
  legacy: false, // 使用 Composition API
  locale: 'zh-CN',
  fallbackLocale: 'en-US',
  messages: {
    'zh-CN': zhCN,
    'en-US': enUS
  }
})

export default i18n
```

### 翻译文件
```typescript
// src/i18n/locales/zh-CN.ts
export default {
  common: {
    save: '保存',
    cancel: '取消',
    confirm: '确认',
    delete: '删除'
  },
  user: {
    profile: {
      title: '个人资料',
      name: '姓名',
      email: '邮箱'
    }
  },
  message: {
    saveSuccess: '保存成功',
    deleteConfirm: '确认删除 {name} 吗？',
    itemCount: '{count} 项'
  }
}
```

## 在组件中使用

### Setup 语法
```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n'

const { t, locale } = useI18n()

const switchLocale = () => {
  locale.value = locale.value === 'zh-CN' ? 'en-US' : 'zh-CN'
}

const deleteUser = (name: string) => {
  const message = t('message.deleteConfirm', { name })
  console.log(message) // 确认删除 张三 吗？
}
</script>

<template>
  <!-- ✅ 好 -->
  <el-button>{{ t('common.save') }}</el-button>
  <h1>{{ t('user.profile.title') }}</h1>
  
  <!-- 参数插值 -->
  <p>{{ t('message.deleteConfirm', { name: userName }) }}</p>
  
  <!-- ❌ 坏 - 硬编码 -->
  <el-button>保存</el-button>
</template>
```

### TypeScript 中使用
```typescript
import { useI18n } from 'vue-i18n'

export function useUserActions() {
  const { t } = useI18n()
  
  const showMessage = () => {
    ElMessage.success(t('message.saveSuccess'))
  }
  
  return { showMessage }
}
```

## Element Plus 国际化

```typescript
// main.ts
import ElementPlus from 'element-plus'
import zhCn from 'element-plus/es/locale/lang/zh-cn'
import en from 'element-plus/es/locale/lang/en'

const locale = ref('zh-CN')

const elLocale = computed(() => 
  locale.value === 'zh-CN' ? zhCn : en
)

app.use(ElementPlus, {
  locale: elLocale.value
})
```

## 复数和格式化

```typescript
// 翻译文件
export default {
  message: {
    // 复数
    itemCount: 'no items | one item | {count} items',
    
    // 日期
    lastLogin: '最后登录: {date}',
    
    // 数字
    price: '价格: {amount}'
  }
}

// 使用
const count = ref(5)
t('message.itemCount', count.value) // "5 items"

t('message.lastLogin', { 
  date: new Date().toLocaleDateString() 
})

t('message.price', { 
  amount: new Intl.NumberFormat('zh-CN').format(1234.56) 
})
```

## 最佳实践

### 键名规范
```typescript
// ✅ 好 - 结构化、语义化
'user.profile.edit'
'product.list.title'
'message.validation.required'

// ❌ 坏
'edit'
'title'
'msg1'
```

### 避免硬编码
```vue
<!-- ❌ 坏 -->
<el-table-column label="姓名" />
<el-button>提交</el-button>

<!-- ✅ 好 -->
<el-table-column :label="t('user.name')" />
<el-button>{{ t('common.submit') }}</el-button>
```

### 参数化文本
```typescript
// ❌ 坏 - 字符串拼接
const message = '欢迎，' + userName + '!'

// ✅ 好 - 使用参数
const message = t('welcome.message', { name: userName })

// 翻译文件
export default {
  welcome: {
    message: '欢迎，{name}！'
  }
}
```

## TypeScript 类型支持

```typescript
// i18n.d.ts
import 'vue-i18n'

declare module 'vue-i18n' {
  export interface DefineLocaleMessage {
    common: {
      save: string
      cancel: string
    }
    user: {
      profile: {
        title: string
      }
    }
  }
}
```

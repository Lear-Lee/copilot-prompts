# å›½é™…åŒ– (i18n) è§„èŒƒ

## æ ¸å¿ƒåŸåˆ™

1. **é›¶ç¡¬ç¼–ç ** - æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬å¿…é¡»ä½¿ç”¨ç¿»è¯‘é”®
2. **ç»“æ„åŒ–é”®å** - ä½¿ç”¨ç‚¹åˆ†å±‚çº§ï¼ˆå¦‚ `user.profile.title`ï¼‰
3. **å‚æ•°åŒ–æ–‡æœ¬** - ä½¿ç”¨å ä½ç¬¦è€Œéå­—ç¬¦ä¸²æ‹¼æ¥

---

## ğŸ¨ å•æ–‡ä»¶ i18n é…ç½®ï¼ˆè½»é‡æ–¹æ¡ˆï¼‰

> **é€‚ç”¨äºä¸æƒ³å¼•å…¥ vue-i18n æ’ä»¶çš„é¡¹ç›®ï¼Œä½¿ç”¨è‡ªå®šä¹‰å®ç°**

### é…ç½®æ–‡ä»¶ç»“æ„
```
src/
â”œâ”€â”€ locales/
â”‚   â””â”€â”€ messages.ts       # ç¿»è¯‘å­—å…¸ï¼ˆé”®å€¼å¯¹æ•°ç»„æ ¼å¼ï¼‰
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ state/
â”‚       â””â”€â”€ locale.ts     # è¯­è¨€çŠ¶æ€ç®¡ç†ï¼ˆPinia Storeï¼‰
â””â”€â”€ main.ts               # å…¨å±€ $t æ–¹æ³•æ³¨å†Œ
```

### 1. ç¿»è¯‘æ–‡ä»¶æ ¼å¼
```typescript
// src/locales/messages.ts
// ç´¢å¼• 0 ä¸ºè‹±æ–‡ï¼Œç´¢å¼• 1 ä¸ºä¸­æ–‡

const messages: Record<string, [string, string]> = {
  // ========== é€šç”¨ ==========
  æ˜¯: ['Yes', 'æ˜¯'],
  å¦: ['No', 'å¦'],
  ç¡®å®š: ['OK', 'ç¡®å®š'],
  å–æ¶ˆ: ['Cancel', 'å–æ¶ˆ'],
  ä¿å­˜: ['Save', 'ä¿å­˜'],
  æäº¤: ['Submit', 'æäº¤'],
  æœç´¢: ['Search', 'æœç´¢'],
  æŸ¥è¯¢: ['Query', 'æŸ¥è¯¢'],
  é‡ç½®: ['Reset', 'é‡ç½®'],
  æ–°å¢: ['Add', 'æ–°å¢'],
  ç¼–è¾‘: ['Edit', 'ç¼–è¾‘'],
  åˆ é™¤: ['Delete', 'åˆ é™¤'],
  æ“ä½œ: ['Operation', 'æ“ä½œ'],
  çŠ¶æ€: ['Status', 'çŠ¶æ€'],
  
  // ========== ä¸šåŠ¡æ¨¡å— ==========
  è®¢å•å·: ['Order No', 'è®¢å•å·'],
  é‡‘é¢: ['Amount', 'é‡‘é¢'],
  // ... æŒ‰æ¨¡å—åˆ†ç»„æ·»åŠ 
}

export default messages
```

### 2. è¯­è¨€çŠ¶æ€ç®¡ç†
```typescript
// src/stores/state/locale.ts
import { ref } from 'vue'
import { defineStore } from 'pinia'

export const useLocaleStore = defineStore('locale', () => {
  const locale = ref<'zh-cn' | 'en'>(
    (localStorage.getItem('locale') as 'zh-cn' | 'en') || 'zh-cn'
  )

  const setLocale = (lang: 'zh-cn' | 'en') => {
    locale.value = lang
    localStorage.setItem('locale', lang)
  }

  const toggleLocale = () => {
    setLocale(locale.value === 'zh-cn' ? 'en' : 'zh-cn')
  }

  return { locale, setLocale, toggleLocale }
})
```

### 3. main.ts å…¨å±€æ³¨å†Œ
```typescript
// src/main.ts
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
import messages from '@/locales/messages'
import { useLocaleStore } from '@/stores'

const app = createApp(App)
const pinia = createPinia()

// âš ï¸ å¿…é¡»å…ˆæ³¨å†Œ piniaï¼Œå†ä½¿ç”¨ store
app.use(pinia)

const localeStore = useLocaleStore()

// æ³¨å†Œå…¨å±€ $t æ–¹æ³•
app.config.globalProperties.$t = (key: string): string => {
  const translation = messages[key]
  if (!translation) {
    console.warn(`[i18n] Missing translation: ${key}`)
    return key
  }
  return translation[localeStore.locale === 'zh-cn' ? 1 : 0] || key
}

app.mount('#app')
```

### 4. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

**æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ï¼š**
```vue
<template>
  <el-button>{{ $t('ä¿å­˜') }}</el-button>
  <el-table-column :label="$t('è®¢å•å·')" prop="orderNo" />
</template>
```

**script ä¸­ä½¿ç”¨ï¼ˆéœ€è·å–å®ä¾‹ï¼‰ï¼š**
```typescript
<script setup lang="ts">
import { getCurrentInstance } from 'vue'

const { appContext } = getCurrentInstance()!
const $t = appContext.config.globalProperties.$t

// æ¶ˆæ¯æç¤º
ElMessage.success($t('ä¿å­˜æˆåŠŸ'))

// ç¡®è®¤å¯¹è¯æ¡†
ElMessageBox.confirm($t('ç¡®è®¤åˆ é™¤å—ï¼Ÿ'), $t('æç¤º'))

// è¡¨å•éªŒè¯
const rules = {
  name: [{ required: true, message: $t('è¯·è¾“å…¥åç§°'), trigger: 'blur' }]
}
</script>
```

### âŒ ç¦æ­¢äº‹é¡¹
```typescript
// âŒ ä¸è¦å¼•å…¥ useI18nï¼ˆé¡¹ç›®æœªä½¿ç”¨ vue-i18nï¼‰
import { useI18n } from 'vue-i18n'

// âŒ ä¸è¦ç¡¬ç¼–ç æ–‡æœ¬
<el-button>ä¿å­˜</el-button>

// âŒ ä¸è¦å­—ç¬¦ä¸²æ‹¼æ¥
const msg = 'åˆ é™¤' + name + 'æˆåŠŸ'
```

---

## Vue I18n æ ‡å‡†é…ç½®ï¼ˆå…¶ä»–é¡¹ç›®ï¼‰

### åŸºç¡€è®¾ç½®
```typescript
// src/i18n/index.ts
import { createI18n } from 'vue-i18n'
import zhCN from './locales/zh-CN'
import enUS from './locales/en-US'

const i18n = createI18n({
  legacy: false, // ä½¿ç”¨ Composition API
  locale: 'zh-CN',
  fallbackLocale: 'en-US',
  messages: {
    'zh-CN': zhCN,
    'en-US': enUS
  }
})

export default i18n
```

### ç¿»è¯‘æ–‡ä»¶
```typescript
// src/i18n/locales/zh-CN.ts
export default {
  common: {
    save: 'ä¿å­˜',
    cancel: 'å–æ¶ˆ',
    confirm: 'ç¡®è®¤',
    delete: 'åˆ é™¤'
  },
  user: {
    profile: {
      title: 'ä¸ªäººèµ„æ–™',
      name: 'å§“å',
      email: 'é‚®ç®±'
    }
  },
  message: {
    saveSuccess: 'ä¿å­˜æˆåŠŸ',
    deleteConfirm: 'ç¡®è®¤åˆ é™¤ {name} å—ï¼Ÿ',
    itemCount: '{count} é¡¹'
  }
}
```

## åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

### Setup è¯­æ³•
```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n'

const { t, locale } = useI18n()

const switchLocale = () => {
  locale.value = locale.value === 'zh-CN' ? 'en-US' : 'zh-CN'
}

const deleteUser = (name: string) => {
  const message = t('message.deleteConfirm', { name })
  console.log(message) // ç¡®è®¤åˆ é™¤ å¼ ä¸‰ å—ï¼Ÿ
}
</script>

<template>
  <!-- âœ… å¥½ -->
  <el-button>{{ t('common.save') }}</el-button>
  <h1>{{ t('user.profile.title') }}</h1>
  
  <!-- å‚æ•°æ’å€¼ -->
  <p>{{ t('message.deleteConfirm', { name: userName }) }}</p>
  
  <!-- âŒ å - ç¡¬ç¼–ç  -->
  <el-button>ä¿å­˜</el-button>
</template>
```

### TypeScript ä¸­ä½¿ç”¨
```typescript
import { useI18n } from 'vue-i18n'

export function useUserActions() {
  const { t } = useI18n()
  
  const showMessage = () => {
    ElMessage.success(t('message.saveSuccess'))
  }
  
  return { showMessage }
}
```

## Element Plus å›½é™…åŒ–

```typescript
// main.ts
import ElementPlus from 'element-plus'
import zhCn from 'element-plus/es/locale/lang/zh-cn'
import en from 'element-plus/es/locale/lang/en'

const locale = ref('zh-CN')

const elLocale = computed(() => 
  locale.value === 'zh-CN' ? zhCn : en
)

app.use(ElementPlus, {
  locale: elLocale.value
})
```

## å¤æ•°å’Œæ ¼å¼åŒ–

```typescript
// ç¿»è¯‘æ–‡ä»¶
export default {
  message: {
    // å¤æ•°
    itemCount: 'no items | one item | {count} items',
    
    // æ—¥æœŸ
    lastLogin: 'æœ€åç™»å½•: {date}',
    
    // æ•°å­—
    price: 'ä»·æ ¼: {amount}'
  }
}

// ä½¿ç”¨
const count = ref(5)
t('message.itemCount', count.value) // "5 items"

t('message.lastLogin', { 
  date: new Date().toLocaleDateString() 
})

t('message.price', { 
  amount: new Intl.NumberFormat('zh-CN').format(1234.56) 
})
```

## æœ€ä½³å®è·µ

### é”®åè§„èŒƒ
```typescript
// âœ… å¥½ - ç»“æ„åŒ–ã€è¯­ä¹‰åŒ–
'user.profile.edit'
'product.list.title'
'message.validation.required'

// âŒ å
'edit'
'title'
'msg1'
```

### é¿å…ç¡¬ç¼–ç 
```vue
<!-- âŒ å -->
<el-table-column label="å§“å" />
<el-button>æäº¤</el-button>

<!-- âœ… å¥½ -->
<el-table-column :label="t('user.name')" />
<el-button>{{ t('common.submit') }}</el-button>
```

### å‚æ•°åŒ–æ–‡æœ¬
```typescript
// âŒ å - å­—ç¬¦ä¸²æ‹¼æ¥
const message = 'æ¬¢è¿ï¼Œ' + userName + '!'

// âœ… å¥½ - ä½¿ç”¨å‚æ•°
const message = t('welcome.message', { name: userName })

// ç¿»è¯‘æ–‡ä»¶
export default {
  welcome: {
    message: 'æ¬¢è¿ï¼Œ{name}ï¼'
  }
}
```

## TypeScript ç±»å‹æ”¯æŒ

```typescript
// i18n.d.ts
import 'vue-i18n'

declare module 'vue-i18n' {
  export interface DefineLocaleMessage {
    common: {
      save: string
      cancel: string
    }
    user: {
      profile: {
        title: string
      }
    }
  }
}
```

# å›½é™…åŒ– (i18n) æœ€ä½³å®è·µ

é€‚ç”¨äºéœ€è¦å¤šè¯­è¨€æ”¯æŒçš„å‰ç«¯é¡¹ç›®

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

1. **é›¶ç¡¬ç¼–ç **: æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬å¿…é¡»ä½¿ç”¨ç¿»è¯‘å‡½æ•°
2. **é”®åè§„èŒƒ**: ä½¿ç”¨ç‚¹åˆ†å±‚çº§ç»“æ„ (`common.save`, `user.profile.title`)
3. **å‚æ•°åŒ–**: åŠ¨æ€å†…å®¹ä½¿ç”¨å‚æ•°æ’å€¼ï¼Œä¸æ‹¼æ¥å­—ç¬¦ä¸²
4. **å›é€€æœºåˆ¶**: æä¾›é»˜è®¤è¯­è¨€ä½œä¸ºå›é€€

## ğŸ”§ æ ‡å‡†é…ç½® (Vue I18n)

### ç›®å½•ç»“æ„
```
src/locales/
â”œâ”€â”€ index.ts           # i18n åˆå§‹åŒ–
â”œâ”€â”€ zh-CN.ts          # ç®€ä½“ä¸­æ–‡
â”œâ”€â”€ en-US.ts          # è‹±æ–‡
â””â”€â”€ ja-JP.ts          # æ—¥æ–‡
```

### ç¿»è¯‘æ–‡ä»¶ç¤ºä¾‹
```typescript
// zh-CN.ts
export default {
  common: {
    save: 'ä¿å­˜',
    cancel: 'å–æ¶ˆ',
    confirm: 'ç¡®è®¤',
    delete: 'åˆ é™¤',
    edit: 'ç¼–è¾‘',
    search: 'æœç´¢'
  },
  user: {
    profile: {
      title: 'ç”¨æˆ·èµ„æ–™',
      name: 'å§“å',
      email: 'é‚®ç®±'
    }
  },
  message: {
    saveSuccess: 'ä¿å­˜æˆåŠŸ',
    deleteConfirm: 'ç¡®è®¤åˆ é™¤ {name} å—ï¼Ÿ',
    itemsSelected: 'å·²é€‰æ‹© {count} é¡¹'
  }
}
```

## ğŸ¨ å•æ–‡ä»¶ i18n é…ç½®ï¼ˆè½»é‡æ–¹æ¡ˆï¼‰

**é€‚ç”¨äºä¸æƒ³å¼•å…¥ vue-i18n æ’ä»¶çš„é¡¹ç›®ï¼Œä½¿ç”¨è‡ªå®šä¹‰å®ç°ï¼š**

### 1. é…ç½®ä½ç½®
- **ç¿»è¯‘æ–‡ä»¶**: `src/locales/messages.ts` (é”®å€¼å¯¹æ•°ç»„æ ¼å¼)
- **è¯­è¨€çŠ¶æ€**: `src/stores/state/locale.ts` (Pinia Store)
- **å…¨å±€æ³¨å†Œ**: `src/main.ts` (è‡ªå®šä¹‰ $t æ–¹æ³•)

### 2. ç¿»è¯‘æ–‡ä»¶æ ¼å¼
```typescript
// src/locales/messages.ts
// ç´¢å¼• 0 ä¸ºè‹±æ–‡ï¼Œç´¢å¼• 1 ä¸ºä¸­æ–‡

const messages: Record<string, [string, string]> = {
  // ========== é€šç”¨ ==========
  æ˜¯: ['Yes', 'æ˜¯'],
  å¦: ['No', 'å¦'],
  ç¡®å®š: ['OK', 'ç¡®å®š'],
  å–æ¶ˆ: ['Cancel', 'å–æ¶ˆ'],
  ç¡®è®¤: ['Confirm', 'ç¡®è®¤'],
  ä¿å­˜: ['Save', 'ä¿å­˜'],
  æäº¤: ['Submit', 'æäº¤'],
  æœç´¢: ['Search', 'æœç´¢'],
  æŸ¥è¯¢: ['Query', 'æŸ¥è¯¢'],
  é‡ç½®: ['Reset', 'é‡ç½®'],
  å¯¼å‡º: ['Export', 'å¯¼å‡º'],
  æ–°å¢: ['Add', 'æ–°å¢'],
  ç¼–è¾‘: ['Edit', 'ç¼–è¾‘'],
  åˆ é™¤: ['Delete', 'åˆ é™¤'],
  è¯¦æƒ…: ['Detail', 'è¯¦æƒ…'],
  æ“ä½œ: ['Operation', 'æ“ä½œ'],
  çŠ¶æ€: ['Status', 'çŠ¶æ€'],
  å¤‡æ³¨: ['Remark', 'å¤‡æ³¨'],
  
  // ========== ä¸šåŠ¡æ¨¡å— ==========
  è®¢å•å·: ['Order No', 'è®¢å•å·'],
  é‡‘é¢: ['Amount', 'é‡‘é¢'],
  // ... æŒ‰æ¨¡å—åˆ†ç»„
}

export default messages
```

### 3. è¯­è¨€çŠ¶æ€ç®¡ç†
```typescript
// src/stores/state/locale.ts
import { ref } from 'vue'
import { defineStore } from 'pinia'

export const useLocaleStore = defineStore('locale', () => {
  // é»˜è®¤ä¸­æ–‡ï¼Œå¯ä» localStorage è¯»å–
  const locale = ref<'zh-cn' | 'en'>(
    (localStorage.getItem('locale') as 'zh-cn' | 'en') || 'zh-cn'
  )

  const setLocale = (lang: 'zh-cn' | 'en') => {
    locale.value = lang
    localStorage.setItem('locale', lang)
  }

  const toggleLocale = () => {
    setLocale(locale.value === 'zh-cn' ? 'en' : 'zh-cn')
  }

  return { locale, setLocale, toggleLocale }
})
```

### 4. main.ts å…¨å±€æ³¨å†Œ
```typescript
// src/main.ts
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
import messages from '@/locales/messages'
import { useLocaleStore } from '@/stores'

const app = createApp(App)
const pinia = createPinia()

// âš ï¸ å¿…é¡»å…ˆæ³¨å†Œ piniaï¼Œå†ä½¿ç”¨ store
app.use(pinia)

// è·å–è¯­è¨€çŠ¶æ€
const localeStore = useLocaleStore()

// æ³¨å†Œå…¨å±€ $t æ–¹æ³•
app.config.globalProperties.$t = (key: string): string => {
  const translation = messages[key]
  if (!translation) {
    console.warn(`[i18n] Missing translation: ${key}`)
    return key
  }
  // ç´¢å¼• 0 ä¸ºè‹±æ–‡ï¼Œç´¢å¼• 1 ä¸ºä¸­æ–‡
  return translation[localeStore.locale === 'zh-cn' ? 1 : 0] || key
}

app.mount('#app')
```

### 5. ä½¿ç”¨æ–¹å¼

**åœ¨æ¨¡æ¿ä¸­ï¼ˆç›´æ¥ä½¿ç”¨ï¼‰ï¼š**
```vue
<template>
  <el-button>{{ $t('ä¿å­˜') }}</el-button>
  <el-table-column :label="$t('è®¢å•å·')" prop="orderNo" />
  <el-tag>{{ $t(row.status === 'success' ? 'æˆåŠŸ' : 'å¤±è´¥') }}</el-tag>
</template>
```

**åœ¨ script ä¸­ï¼ˆéœ€è¦è·å–å®ä¾‹ï¼‰ï¼š**
```typescript
<script setup lang="ts">
import { getCurrentInstance } from 'vue'

// âš ï¸ å¿…é¡»é€šè¿‡ getCurrentInstance è·å–
const { appContext } = getCurrentInstance()!
const $t = appContext.config.globalProperties.$t

// ä½¿ç”¨
ElMessage.success($t('ä¿å­˜æˆåŠŸ'))
ElMessageBox.confirm($t('ç¡®è®¤åˆ é™¤å—ï¼Ÿ'), $t('æç¤º'))

// è¡¨å•éªŒè¯
const rules = {
  name: [{ required: true, message: $t('è¯·è¾“å…¥åç§°'), trigger: 'blur' }]
}
</script>
```

### 6. æ·»åŠ æ–°ç¿»è¯‘é”®

åœ¨ `src/locales/messages.ts` ä¸­æŒ‰åˆ†ç±»æ·»åŠ ï¼š

```typescript
const messages: Record<string, [string, string]> = {
  // ========== å·²æœ‰å†…å®¹ ==========
  
  // ========== æ–°å¢ï¼šäº¤æ˜“æ¨¡å— ==========
  æ±‡æ¬¾è®¢å•: ['Remittance Order', 'æ±‡æ¬¾è®¢å•'],
  æ”¶æ¬¾è®¢å•: ['Collection Order', 'æ”¶æ¬¾è®¢å•'],
  äº¤æ˜“æµæ°´: ['Transaction Record', 'äº¤æ˜“æµæ°´'],
  
  // ========== æ–°å¢ï¼šå®¢æˆ·æ¨¡å— ==========
  å®¢æˆ·åç§°: ['Customer Name', 'å®¢æˆ·åç§°'],
  è”ç³»æ–¹å¼: ['Contact', 'è”ç³»æ–¹å¼'],
}
```

### âŒ ç¦æ­¢äº‹é¡¹

```typescript
// âŒ ä¸è¦å¼•å…¥ useI18nï¼ˆé¡¹ç›®æœªä½¿ç”¨ vue-i18nï¼‰
import { useI18n } from 'vue-i18n'

// âŒ ä¸è¦ç¡¬ç¼–ç æ–‡æœ¬
<el-button>ä¿å­˜</el-button>

// âŒ ä¸è¦å­—ç¬¦ä¸²æ‹¼æ¥
const msg = 'åˆ é™¤' + name + 'æˆåŠŸ'

// âŒ ä¸è¦åœ¨ç¿»è¯‘å€¼ä¸­ä½¿ç”¨å˜é‡ï¼ˆå½“å‰å®ç°ä¸æ”¯æŒï¼‰
$t('å·²é€‰æ‹© {count} é¡¹', { count: 5 })  // ä¸æ”¯æŒï¼
// âœ… æ›¿ä»£æ–¹æ¡ˆ
`${$t('å·²é€‰æ‹©')} ${count} ${$t('é¡¹')}`
```

## âœ… æœ€ä½³å®è·µ

### Vue ç»„ä»¶ä¸­ä½¿ç”¨
```vue
<script setup lang="ts">
import { getCurrentInstance } from 'vue'

// è·å– $t å‡½æ•°
const { appContext } = getCurrentInstance()!
const $t = appContext.config.globalProperties.$t
</script>

<template>
  <!-- âœ… å¥½ -->
  <el-button>{{ $t('common.save') }}</el-button>
  <el-table-column :label="$t('user.profile.name')" />
  
  <!-- å‚æ•°æ’å€¼ -->
  <p>{{ $t('message.deleteConfirm', { name: userName }) }}</p>
  
  <!-- å¤æ•°å¤„ç† -->
  <span>{{ $t('message.itemsSelected', { count: selectedCount }) }}</span>
  
  <!-- âŒ å -->
  <el-button>ä¿å­˜</el-button>
  <p>ç¡®è®¤åˆ é™¤ {{ userName }} å—ï¼Ÿ</p>
</template>
```

### TypeScript ä¸­ä½¿ç”¨
```typescript
import { ElMessage } from 'element-plus'

// âœ… å¥½
ElMessage.success($t('message.saveSuccess'))

// å¸¦å‚æ•°
ElMessage.warning($t('message.deleteConfirm', { name: user.name }))

// âŒ å
ElMessage.success('ä¿å­˜æˆåŠŸ')
```

### åŠ¨æ€æ–‡æœ¬æ˜ å°„
```typescript
// âœ… å¥½ - ä½¿ç”¨æ˜ å°„å¯¹è±¡
const statusMap = {
  pending: $t('status.pending'),
  success: $t('status.success'),
  error: $t('status.error')
}

const statusText = statusMap[status]

// æˆ–åœ¨æ¨¡æ¿ä¸­
{{ { 0: $t('type.input'), 1: $t('type.output') }[row.type] }}

// âŒ å - ç¡¬ç¼–ç 
const statusMap = {
  pending: 'å¾…å¤„ç†',
  success: 'æˆåŠŸ',
  error: 'å¤±è´¥'
}
```

## âš ï¸ ç¦æ­¢æ¨¡å¼

- âŒ ç¡¬ç¼–ç ä¸­æ–‡/è‹±æ–‡æ–‡æœ¬
- âŒ å­—ç¬¦ä¸²æ‹¼æ¥: `'åˆ é™¤' + name + 'å—ï¼Ÿ'`
- âŒ åœ¨ä»£ç ä¸­åˆ‡æ¢è¯­è¨€é€»è¾‘: `if (lang === 'zh') { ... }`
- âŒ é‡å¤çš„ç¿»è¯‘é”®

## ğŸ“‹ ä»£ç å®¡æŸ¥æ¸…å•

- [ ] æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬ä½¿ç”¨ `$t()`
- [ ] ç¿»è¯‘é”®ä½¿ç”¨ç‚¹åˆ†å±‚çº§ç»“æ„
- [ ] åŠ¨æ€å†…å®¹ä½¿ç”¨å‚æ•°æ’å€¼
- [ ] æ‰€æœ‰è¯­è¨€æ–‡ä»¶æœ‰ç›¸åŒçš„é”®ç»“æ„
- [ ] ElMessage/ElMessageBox çš„æ–‡æœ¬å·²ç¿»è¯‘
- [ ] è¡¨å•éªŒè¯æ¶ˆæ¯å·²ç¿»è¯‘

## ğŸ”§ å¸¸è§åœºæ™¯

### è¡¨å•éªŒè¯
```typescript
const rules = {
  name: [
    { 
      required: true, 
      message: $t('validation.required', { field: $t('user.profile.name') }), 
      trigger: 'blur' 
    },
    { 
      min: 2, 
      max: 20, 
      message: $t('validation.length', { min: 2, max: 20 }), 
      trigger: 'blur' 
    }
  ]
}
```

### ç¡®è®¤å¯¹è¯æ¡†
```typescript
const handleDelete = async (row: User) => {
  try {
    await ElMessageBox.confirm(
      $t('message.deleteConfirm', { name: row.name }),
      $t('common.warning'),
      {
        confirmButtonText: $t('common.confirm'),
        cancelButtonText: $t('common.cancel'),
        type: 'warning'
      }
    )
    // æ‰§è¡Œåˆ é™¤
  } catch (err) {
    // ç”¨æˆ·å–æ¶ˆ
  }
}
```

### æ—¶é—´æ ¼å¼åŒ–
```typescript
// ä½¿ç”¨ i18n çš„æ—¥æœŸæ ¼å¼åŒ–
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat(locale.value, {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date)
}
```

## ğŸŒ è¯­è¨€åˆ‡æ¢

```typescript
import { useI18n } from 'vue-i18n'

const { locale } = useI18n()

// åˆ‡æ¢è¯­è¨€
const changeLanguage = (lang: 'zh-CN' | 'en-US') => {
  locale.value = lang
  localStorage.setItem('language', lang)
}
```

---

## âš ï¸ é‡è¦ï¼šé…ç½®æ–‡ä»¶ç®¡ç†

### Copilot é…ç½® .gitignore

**æ¨èåšæ³•ï¼š**å°†è‡ªåŠ¨ç”Ÿæˆçš„ `.github/copilot-instructions.md` æ·»åŠ åˆ° `.gitignore`

```gitignore
# Copilot é…ç½®(è‡ªåŠ¨ç”Ÿæˆ)
.github/copilot-instructions.md
```

**é€‚ç”¨é¡¹ç›®ï¼š**
- éœ€è¦å›½é™…åŒ–çš„ Web åº”ç”¨
- Vue.jsã€Reactã€Angular é¡¹ç›®
- å¤šè¯­è¨€æ”¯æŒçš„å‰ç«¯é¡¹ç›®

**è¯¦ç»†æŒ‡å—**: å‚è€ƒ [Copilot .gitignore é€šç”¨æŒ‡å—](../docs/guides/COPILOT_GITIGNORE_GUIDE.md)
